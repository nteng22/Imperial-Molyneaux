# Make the Genus names into row names so when the dataframe is all numbers.
raw_data <- genus_aggregated
raw_data <- column_to_rownames(raw_data, var = "Phylum")
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences"
#xlim = c(0, 250000)
)
# Find the sample with the smallest number of reads.
col_sums <- colSums(raw_data)
col_sums <- as.data.frame(col_sums)
col_sums
View(col_sums)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences"
#xlim = c(0, 20000)
)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences"
xlim = c(0, 20000)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences",
xlim = c(0, 20000)
)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences",
xlim = c(0, 30000)
)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences",
xlim = c(0, 300000)
)
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences",
xlim = c(0, 100000)
)
# Set the file location
setwd("Y://Phil/16S Raw Data/180719_MSQ92/Open/5_otus/")
# Set the file location
setwd("Y://Phil/16S Raw Data/190208_MSQ92/Open/5_otus/")
#### Make the biom file into a readable format ####
# Import the biom file.
biom <- import_biom("otu_table_mc2_w_tax_no_pynast_failures.biom")
# Check the contents of the file.
biom
# Extract the otu table from the phyloseq object.
otu_data <- otu_table(biom)
# Convert the otu table into a dataframe.
otu_data <- as.data.frame(otu_data)
otu_data
# Extract the taxonomic table from the phyloseq object.
tax_data <- tax_table(biom)
tax_data
# Convert the taxonomic table into a dataframe.
tax_data <- as.data.frame(tax_data)
tax_data
# Rename the columns in the taxonomic data to be more meaningful using dplyr.
tax_data <- tax_data %>%
dplyr::rename(
Kingdom = Rank1,
Phylum = Rank2,
Class = Rank3,
Order = Rank4,
Family = Rank5,
Genus = Rank6,
Species = Rank7
)
# Check the renamed dataframe.
tax_data
# Combine the taxonomic data and the otu data together into one dataframe.
# The rows are all in the same order so this works okay.
taxa_otu_data <- cbind(tax_data, otu_data)
# Check the new combined dataframe.
taxa_otu_data
# Select the Genus column and count data into a new dataframe.
genus_data_subset <- taxa_otu_data %>% select(Phylum, PRO.1264:ncol(taxa_otu_data))
View(taxa_otu_data)
# Select the Genus column and count data into a new dataframe.
genus_data_subset <- taxa_otu_data %>% select(Phylum, "27.2.BAL":ncol(taxa_otu_data))
# Rename the unclassified data ("g__", NA) to "Unclassified".
genus_data_subset$Phylum <- ifelse(genus_data_subset$Phylum== "P__", "Unclassified", genus_data_subset$Phylum)
genus_data_subset$Phylum[is.na(genus_data_subset$Phylum)] <- "Unclassified"
# Rename two of the genus names that have square brackets added.
genus_data_subset$Genus <- ifelse(genus_data_subset$Genus== "g__[Ruminococcus]", "Ruminococcus", genus_data_subset$Genus)
genus_data_subset$Genus <- ifelse(genus_data_subset$Genus== "g__[Eubacterium]", "Eubacterium", genus_data_subset$Genus)
# Replace the "g__" in the Genus names with nothing.
genus_data_subset$Phylum <- gsub("p__", "" , genus_data_subset$Phylum)
# Make the Genus column into a factor.
genus_data_subset$Phylum <- as.factor(genus_data_subset$Phylum)
# Sum all the count data by the genus groups.
genus_aggregated <- aggregate(.~Phylum, genus_data_subset, sum)
genus_aggregated
# Select every row except the "Unclassified" row. The "!" means those rows are removed.
genus_aggregated <- dplyr::filter(genus_aggregated,
!Phylum == "Unclassified")
# Make the Genus names into row names so when the dataframe is all numbers.
raw_data <- genus_aggregated
raw_data <- column_to_rownames(raw_data, var = "Phylum")
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences",
xlim = c(0, 100000)
)
# Find the sample with the smallest number of reads.
col_sums <- colSums(raw_data)
col_sums <- as.data.frame(col_sums)
col_sums
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of genus",
xlab = "No. of sequences"
#xlim = c(0, 100000)
)
# Find the sample with the smallest number of reads.
col_sums <- colSums(raw_data)
col_sums <- as.data.frame(col_sums)
col_sums
# Alternatively for more samples you can see which samples have counts less than a certain number i.e 20000 in this case.
sample_less_than <- dplyr::filter(col_sums, col_sums < 20000)
sample_less_than
# Draw a rarecure plot to compare the depth of sequencing of the samples.
# The "t(raw_data)" transposes the dataframe so the genus go from rows to columns within this function.
rarecurve(t(raw_data),
step = 200,
sample = 1000,
col = "blue",
cex = 0.4,
label = TRUE,
#label = FALSE,
lwd = 0.001,
ylab = "No. of phyla",
xlab = "No. of sequences"
#xlim = c(0, 100000)
)
setwd("~/OneDrive - Imperial College London/2023/Experiments/16S database/Healthy-controls/")
setwd("/Documents and Settings/mteng/OneDrive - Imperial College London/2023/Experiments/16S database/Healthy-controls/")
setwd("C://Documents and Settings/mteng/OneDrive - Imperial College London/2023/Experiments/16S database/IPF-stable-progressive/")
library(readxl)
library(tidyverse)
library(dplyr)
controls <- readxl::read_xlsx("../16S-Sequencing-Summary-Runs.txt")
controls$`Sequencing run` <- as.factor(controls$`Sequencing run`)
controls <- readxl::read_xlsx("../16S-Sequencing-Summary-Runs.xlsx")
controls <- readxl::read_xlsx("../16S-Sequencing-Summary-Runs.xlsx", sheet=9)
View(controls)
controls$`Sequencing run` <- as.factor(controls$`Sequencing run`)
group <- readxl::read_xlsx("../16S-Sequencing-Summary-Runs.xlsx", sheet=9)
group$`Sequencing run` <- as.factor(controls$`Sequencing run`)
group_IPF-HC %>% group %>%
filter(Diagnosis == "IPF" | Diagnosis =="Control")
group_IPF_HC %>% group %>%
filter(Diagnosis == "IPF" | Diagnosis =="Control")
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" | Diagnosis =="Control")
View(group_IPF_HC)
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" && "Control")
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" & "Control")
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" | "Control")
?logical
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" | Diagnosis == "Control")
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" | Diagnosis == "control")
View(group_IPF_HC)
group_IPF_HC <- group %>%
filter(Diagnosis == "IPF" | Diagnosis == "Healthy" |
Diagnosis == "Healthy control")
View(group_IPF_HC)
samples <- readxl:read_xlsx("HC-IPF_map.xlsx")
group$`Sequencing run` <- as.factor(controls$`Sequencing run`)
library(readxl)
samples <- readxl:read_xlsx("HC-IPF_map.xlsx")
samples <- readxl::read_xlsx("HC-IPF_map.xlsx")
samples$`Sequencing run` <- as.factor(controls$`Sequencing run`)
samples$`Sequencing run` <- as.factor(controls$`Sequencing run`)
MSQ104 <- read_tsv("../MSQ-maps/MSQ104-Map.txt")
samples$`Sequencing run` <- as.factor(samples$`Sequencing run`)
MSQ104_barcodes <- inner_join(MSQ104, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
View(MSQ104_barcodes)
setwd("C://Documents and Settings/mteng/OneDrive - Imperial College London/2023/Experiments/16S database/IPF-stable-progressive/")
library(readxl)
library(tidyverse)
library(dplyr)
group <- readxl::read_xlsx("../16S-Sequencing-Summary-Runs.xlsx", sheet=9)
samples <- readxl::read_xlsx("HC-IPF_map.xlsx")
MSQ75 <- read_tsv("../MSQ-maps/MSQ75-Map.txt")
MSQ75_barcodes <- inner_join(MSQ75, samples, by = "#SampleID")
samples <- readxl::read_xlsx("HC-IPF_map.xlsx")
samples$`Sequencing run` <- as.factor(samples$`Sequencing run`)
MSQ75 <- read_tsv("../MSQ-maps/MSQ75-Map.txt")
MSQ75_barcodes <- inner_join(MSQ75, samples, by = "#SampleID")
samples <- readxl::read_xlsx("HC-IPF_map.xlsx")
samples <- readxl::read_xlsx("HC-IPF_map.xlsx")
samples$`Sequencing run` <- as.factor(samples$`Sequencing run`)
MSQ75 <- read_tsv("../MSQ-maps/MSQ75-Map.txt")
MSQ75_barcodes <- inner_join(MSQ75, samples, by = "#SampleID")
MSQ81 <- read_tsv("../MSQ-maps/MSQ81-Map.txt")
MSQ81_barcodes <- inner_join(MSQ81, samples, by = "#SampleID")
MSQ82 <- read_tsv("../MSQ-maps/MSQ82-Map.txt")
MSQ82_barcodes <- inner_join(MSQ82, samples, by = "#SampleID")
MSQ91 <- read_tsv("../MSQ-maps/MSQ91-Map.txt")
MSQ92_barcodes <- inner_join(MSQ91, samples, by = "#SampleID")
MSQ92 <- read_tsv("../MSQ-maps/MSQ92-Map.txt")
MSQ92_barcodes <- inner_join(MSQ92, samples, by = "#SampleID")
MSQ104 <- read_tsv("../MSQ-maps/MSQ104-Map.txt")
MSQ104_barcodes <- inner_join(MSQ104, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ113 <- read_tsv("../MSQ-maps/MSQ113-Map.txt")
MSQ113_barcodes <- inner_join(MSQ113, samples, by = "#SampleID")
MSQ114 <- read_tsv("../MSQ-maps/MSQ114-Map.txt")
MSQ114_barcodes <- inner_join(MSQ114, samples, by = "#SampleID")
MSQ140 <- read_tsv("../MSQ-maps/MSQ140-Map.txt")
MSQ140_barcodes <- inner_join(MSQ140, samples, by = "#SampleID")
MSQ139 <- read_tsv("../MSQ-maps/MSQ139-Map.txt")
MSQ139_barcodes <- inner_join(MSQ139, samples, by = "#SampleID")%>%
select(-Primer_Plate, -LANE, -SubjID)
manifest <- rbind(MSQ75_barcodes,
MSQ81_barcodes,
MSQ82_barcodes,
MSQ91_barcodes,
MSQ92_barcodes,
MSQ104_barcodes,
MSQ113_barcodes,
MSQ114_barcodes,
MSQ139_barcodes,
MSQ140_barcodes)
MSQ91 <- read_tsv("../MSQ-maps/MSQ91-Map.txt")
MSQ91_barcodes <- inner_join(MSQ91, samples, by = "#SampleID")
MSQ92 <- read_tsv("../MSQ-maps/MSQ92-Map.txt")
MSQ92_barcodes <- inner_join(MSQ92, samples, by = "#SampleID")
MSQ104 <- read_tsv("../MSQ-maps/MSQ104-Map.txt")
MSQ104_barcodes <- inner_join(MSQ104, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ113 <- read_tsv("../MSQ-maps/MSQ113-Map.txt")
MSQ113_barcodes <- inner_join(MSQ113, samples, by = "#SampleID")
MSQ114 <- read_tsv("../MSQ-maps/MSQ114-Map.txt")
MSQ114_barcodes <- inner_join(MSQ114, samples, by = "#SampleID")
MSQ139 <- read_tsv("../MSQ-maps/MSQ139-Map.txt")
MSQ139_barcodes <- inner_join(MSQ139, samples, by = "#SampleID")%>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ140 <- read_tsv("../MSQ-maps/MSQ140-Map.txt")
MSQ140_barcodes <- inner_join(MSQ140, samples, by = "#SampleID")
manifest <- rbind(MSQ75_barcodes,
MSQ81_barcodes,
MSQ82_barcodes,
MSQ91_barcodes,
MSQ92_barcodes,
MSQ104_barcodes,
MSQ113_barcodes,
MSQ114_barcodes,
MSQ139_barcodes,
MSQ140_barcodes)
MSQ113_barcodes <- inner_join(MSQ113, samples, by = "#SampleID") %>%
select(-Primer_plate, -LANE, -SubjID)
MSQ113_barcodes <- inner_join(MSQ113, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ75_barcodes <- inner_join(MSQ75, samples, by = "#SampleID")
MSQ81 <- read_tsv("../MSQ-maps/MSQ81-Map.txt")
MSQ81_barcodes <- inner_join(MSQ81, samples, by = "#SampleID")
MSQ82 <- read_tsv("../MSQ-maps/MSQ82-Map.txt")
MSQ82_barcodes <- inner_join(MSQ82, samples, by = "#SampleID")
MSQ91 <- read_tsv("../MSQ-maps/MSQ91-Map.txt")
MSQ91_barcodes <- inner_join(MSQ91, samples, by = "#SampleID")
MSQ92 <- read_tsv("../MSQ-maps/MSQ92-Map.txt")
MSQ92_barcodes <- inner_join(MSQ92, samples, by = "#SampleID")
MSQ104 <- read_tsv("../MSQ-maps/MSQ104-Map.txt")
MSQ104_barcodes <- inner_join(MSQ104, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ113 <- read_tsv("../MSQ-maps/MSQ113-Map.txt")
MSQ113_barcodes <- inner_join(MSQ113, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ114 <- read_tsv("../MSQ-maps/MSQ114-Map.txt")
MSQ114_barcodes <- inner_join(MSQ114, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ139 <- read_tsv("../MSQ-maps/MSQ139-Map.txt")
MSQ139_barcodes <- inner_join(MSQ139, samples, by = "#SampleID")%>%
select(-Primer_Plate, -LANE, -SubjID)
MSQ140 <- read_tsv("../MSQ-maps/MSQ140-Map.txt")
MSQ140_barcodes <- inner_join(MSQ140, samples, by = "#SampleID") %>%
select(-Primer_Plate, -LANE, -SubjID)
manifest <- rbind(MSQ75_barcodes,
MSQ81_barcodes,
MSQ82_barcodes,
MSQ91_barcodes,
MSQ92_barcodes,
MSQ104_barcodes,
MSQ113_barcodes,
MSQ114_barcodes,
MSQ139_barcodes,
MSQ140_barcodes)
colnames(manifest)
colnames(HC_manifest) <- c("sample-id",
"BarcodeSequence",
"LinkerPrimerSequence",
"Host",
"Amp_Well_Plate",
"MSQ",
"PI",
"Description",
"Level1",
"Sequencing-run",
"Diagnosis")
write.table(manifest, file = "Manifest-map.txt", sep = "\t",
row.names = FALSE, quote = FALSE)
setwd("~/GitHub/Imperial-Molyneaux/IPF-progressive/Genus/")
getwd()
setwd("/Volumes/nteng/GitHub/Imperial-Molyneaux/IPF-progressive/Genus/")
# Read in the saved csv file from previously
normalised_data <- read_csv("Genus-normalised.csv") %>%
filter(!Diagnosis == "Negative") #remove controls
#install.packages("dplyr")
library("dplyr")
#install.packages("tidyverse")
library("tidyverse")
#install.packages("vegan")
library("vegan")
#install.packages("reshape2")
library("reshape2")
# Read in the saved csv file from previously
normalised_data <- read_csv("Genus-normalised.csv") %>%
filter(!Diagnosis == "Negative") #remove controls
abund_table <- normalised_data %>%
select(5:ncol(normalised_data)) # Only select the reads
rowSums(abund_table) #check if in percentages
abund_table <- abund_table/rowSums(abund_table)*100
metadata <- normalised_data %>%
select(`sample-id`:Diagnosis)
metadata$Level1 <- gsub("Controls", "Control", metadata$Level1)
metadata$Level1 <- as.factor(metadata$Level1)
metadata$`Sequencing run` <- as.factor(metadata$`Sequencing run`)
metadata$Diagnosis <- as.factor(metadata$Diagnosis)
# Make a dataframe "top" that contains the top 10 most abundant genera. You can alter these as you want.
top <- abund_table[,order(colSums(abund_table),decreasing=TRUE)]
#Extract list of top N Taxa
N <- 10
taxa_list <- colnames(top)[1:N]
N <- length(taxa_list)
top <- data.frame(top[,colnames(top) %in% taxa_list])
top
# Make a dataframe "other" that contains all of the other genera. You can alter these as you want.
other <- abund_table[,order(colSums(abund_table),decreasing=TRUE)]
# Extract list of top N Taxa
N <- dim(normalised_data)[2] # This needs to be the total number of colums in the dataframe.
# dim(normalised_data)[2], calls the second element of the vector dim(normalised_data)
taxa_list2 <- colnames(other)[11:N]
N <- length(taxa_list2)
Others <- data.frame(other[,colnames(other) %in% taxa_list2])
Others
# Sum all the other columns into one.
Others <- rowSums(Others)
Others <- as.data.frame(Others)
Others
# Combine the top 10 genus and the other column and check the rows all still add up to 100.
top_other <- cbind(top, Others)
top_other
top_other_rowsums <- rowSums(top_other)
top_other_rowsums <- as.data.frame(top_other_rowsums)
top_other_rowsums
# Use the data to calculate the clustering for the heatmap
# Calculate the Bray-Curtis dissimilarity matrix on the sample rows
# You can change the method e.g. Jacard, see manual for more information
data_dist_rows <- vegdist(top_other, method = "bray")
# Cluster the rows by hierarchical clustering
row_clustering <- hclust(data_dist_rows, "average")
# Calculate the Bray-Curtis dissimilarity matrix on the genus columns
data_dist_columns <- vegdist(t(top_other), method = "bray")
# Cluster the columns by hierarchical clustering
col_clustering <- hclust(data_dist_columns, "average")
# Define the color palette for the heatmap colours
colour_palette <- colorRampPalette(colors=c("white",
"orange",
"darkorange",
"red",
"darkred",
"black"))(100)
# This is to add annotation to the heatmap
# Make a dataframe of the variable you want to have 'annotated' with the heatmap
annot_df1 <- data.frame(Level1 = metadata$Level1)
# Make a list, where the levels of the dataframe are allocated a colour
# colour list can be found here: http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf
col1 = list(Level1 = c("Fibrosis"= "hotpink3",
"Control" = "deepskyblue2"))
# Add everything together, change the df, col and title accordingly.
sidebar_annotation1 <- rowAnnotation(df = annot_df1, # Dataframe containing treatment groups
col = col1, # The list of treatment groups and their assigned colours
show_annotation_name = FALSE,
annotation_width = unit(c(.2), "cm"), # Set the width of the side bar
annotation_legend_param = list(title = "Diagnosis", # Sidebar legend title
title_gp = gpar(fontsize = 7), # Sidebar legend title font size
labels_gp = gpar(fontsize = 7))) # Sidebar legend label font size
library("ComplexHeatmap")
# Add everything together, change the df, col and title accordingly.
sidebar_annotation1 <- rowAnnotation(df = annot_df1, # Dataframe containing treatment groups
col = col1, # The list of treatment groups and their assigned colours
show_annotation_name = FALSE,
annotation_width = unit(c(.2), "cm"), # Set the width of the side bar
annotation_legend_param = list(title = "Diagnosis", # Sidebar legend title
title_gp = gpar(fontsize = 7), # Sidebar legend title font size
labels_gp = gpar(fontsize = 7))) # Sidebar legend label font size
# Create the heatmap
heatmap <- Heatmap(as.matrix(top_other), # The dataframe containing the heatmap data
name = "Proportion", # Name is used as the title of the heatmap legend if shown
col = colour_palette, # The predefined colour palette
cluster_rows = row_clustering, # Cluster the rows using the predefined clustering
#cluster_columns = col_clustering, # Cluster the columns using the predefined clustering
show_row_names = TRUE, # Show or hide the row names, TRUE to show rownames
row_names_gp = gpar(fontsize = 6), # Row name font size
column_names_gp = gpar(fontsize = 8, # Column name font size
fontface = "italic"), # Column names in italics
column_title_gp = gpar(fontsize = 8), # Column title font size
row_title = "Samples", # Set row title
row_title_gp = gpar(fontsize = 8), # Set row title font size
column_title = "Family", # Set column title
column_title_side = "bottom", # Set column title font size
heatmap_legend_param = list(title = "Relative\nabundance\n(%)", # Set legend title
at = c(0,20,40,60,80,100), # Set legend scale breaks
labels = c("0","20","40","60","80","100"), # Set legend scale labels
title_gp = gpar(fontsize = 8), # Set legend title font size
labels_gp = gpar(fontsize = 8))) # Set legend label font size
# Combine the heatmap and the annotation together in the order in which they are to appear
p <- heatmap + sidebar_annotation1
p
